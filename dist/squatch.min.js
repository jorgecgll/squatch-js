!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.squatch=t():e.squatch=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){return x}function o(){return O}function s(e){(e.tenantAlias.match("^test")||e.debug)&&f.default.enable("squatch-js*"),E("initializing ...");var t={tenantAlias:e.tenantAlias,domain:e.domain};x=new b.default(t),O=new p.default(t),E("Widget API instance",x),E("widgets instance",O)}function a(e){e()}function u(e){o().autofill(e)}function c(e){o().submitEmail(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetApi=t.CtaWidget=t.PopupWidget=t.EmbedWidget=t.Widgets=void 0,t.api=i,t.widgets=o,t.init=s,t.ready=a,t.autofill=u,t.submitEmail=c;var l=n(2);Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})});var h=n(3),f=r(h),d=n(7),p=r(d),m=n(30),v=n(35),y=n(36),g=n(11),b=r(g),w=n(37),_=r(w);f.default.disable("squatch-js*");var E=(0,f.default)("squatch-js");t.Widgets=p.default,t.EmbedWidget=m.EmbedWidget,t.PopupWidget=v.PopupWidget,t.CtaWidget=y.CtaWidget,t.WidgetApi=b.default;var x=null,O=null;window&&(0,_.default)()},function(e,t){"use strict";function n(){console.log("Having trouble using Squatch.js? Go to https://docs.referralsaasquatch.com/developer/ for tutorials, references and error codes.")}Object.defineProperty(t,"__esModule",{value:!0}),t.help=n},function(e,t,n){(function(r){function i(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function o(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,r)}}function s(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function u(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof r&&"env"in r&&(e=r.env.DEBUG),e}function c(){try{return window.localStorage}catch(e){}}t=e.exports=n(5),t.log=s,t.formatArgs=o,t.save=a,t.load=u,t.useColors=i,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(u())}).call(t,n(4))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function o(e){if(h===clearTimeout)return clearTimeout(e);if((h===r||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function s(){m&&d&&(m=!1,d.length?p=d.concat(p):v=-1,p.length&&a())}function a(){if(!m){var e=i(s);m=!0;for(var t=p.length;t;){for(d=p,p=[];++v<t;)d&&d[v].run();v=-1,t=p.length}d=null,m=!1,o(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var l,h,f=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{h="function"==typeof clearTimeout?clearTimeout:r}catch(e){h=r}}();var d,p=[],m=!1,v=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new u(e,t)),1!==p.length||m||i(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t,n){function r(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}function i(e){function n(){if(n.enabled){var e=n,r=+new Date,i=r-(c||r);e.diff=i,e.prev=c,e.curr=r,c=r;for(var o=new Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];o[0]=t.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var a=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;a++;var i=t.formatters[r];if("function"==typeof i){var s=o[a];n=i.call(e,s),o.splice(a,1),a--}return n}),t.formatArgs.call(e,o);var u=n.log||t.log||console.log.bind(console);u.apply(e,o)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=r(e),"function"==typeof t.init&&t.init(n),n}function o(e){t.save(e),t.names=[],t.skips=[];for(var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&(e=n[i].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function s(){t.enable("")}function a(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1}function u(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=i.debug=i.default=i,t.coerce=u,t.disable=s,t.enable=o,t.enabled=a,t.humanize=n(6),t.names=[],t.skips=[],t.formatters={};var c},function(e,t){function n(e){if(e=String(e),!(e.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*l;case"days":case"day":case"d":return n*c;case"hours":case"hour":case"hrs":case"hr":case"h":return n*u;case"minutes":case"minute":case"mins":case"min":case"m":return n*a;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function r(e){return e>=c?Math.round(e/c)+"d":e>=u?Math.round(e/u)+"h":e>=a?Math.round(e/a)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function i(e){return o(e,c,"day")||o(e,u,"hour")||o(e,a,"minute")||o(e,s,"second")||e+" ms"}function o(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var s=1e3,a=60*s,u=60*a,c=24*u,l=365.25*c;e.exports=function(e,t){t=t||{};var o=typeof e;if("string"===o&&e.length>0)return n(e);if("number"===o&&isNaN(e)===!1)return t.long?i(e):r(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(3),a=r(s),u=n(8),c=r(u),l=n(10),h=r(l),f=n(11),d=r(f),p=n(30),m=r(p),v=n(35),y=r(v),g=n(36),b=r(g),w=(0,a.default)("squatch-js:widgets"),_=function(){function e(t){i(this,e),this.tenantAlias=t.tenantAlias,this.api=new d.default(t),this.eventBus=h.default,this.domain=t.domain||"",this.eventBus.addEventListener("submit_email",e.cb)}return o(e,[{key:"createCookieUser",value:function(t){var n=this;return new c.default(function(r,i){try{n.api.cookieUser(t).then(function(e){r({widget:n.renderWidget(e,t),user:e.user})}).catch(function(n){n.apiErrorCode&&e.renderErrorWidget(n,t.engagementMedium),i(n)})}catch(e){throw new Error(e)}})}},{key:"upsertUser",value:function(t){var n=this;return new c.default(function(r,i){try{n.api.upsertUser(t).then(function(e){r({widget:n.renderWidget(e,t),user:e.user})}).catch(function(n){n.apiErrorCode&&e.renderErrorWidget(n,t.engagementMedium),w(n),i(n)})}catch(e){throw new Error(e)}})}},{key:"render",value:function(t){var n=this;return new c.default(function(r,i){try{n.api.cookieUser(t).then(function(e){r({widget:n.renderWidget({template:e},t),user:e.user})}).catch(function(n){n.apiErrorCode&&e.renderErrorWidget(n,t.engagementMedium),i(n)})}catch(e){throw new Error(e)}})}},{key:"autofill",value:function(e){"function"==typeof e&&this.api.squatchReferralCookie().then(e).catch(function(e){throw e});var t=document.querySelectorAll(e);if(!(t.length>0))throw w("Element id/class or function missing"),new Error("Element id/class or function missing");t=t[0],this.api.squatchReferralCookie().then(function(e){t.value=e.code}).catch(function(e){throw e})}},{key:"submitEmail",value:function(t){this.eventBus.removeEventListener("submit_email",e.cb),this.eventBus.addEventListener("submit_email",t)}},{key:"renderWidget",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{widgetType:"",engagementMedium:""};if(w("Rendering Widget..."),!t)throw new Error("Unable to get a response");if(!t.jsOptions)throw new Error("Missing jsOptions in response");var r=void 0,i=!1,o=!1,s=t.jsOptions||"",a={content:t.template,type:n.widgetType||s.widget.defaultWidgetType,api:this.api,domain:this.domain};if(s.widgetUrlMappings&&s.widgetUrlMappings.forEach(function(n){e.matchesUrl(n.url)&&("CONVERSION_WIDGET"!==n.widgetType||t.user.referredBy&&t.user.referredBy.code?(i=n.displayOnLoad,o=n.showAsCTA,w("Display "+n.widgetType+" on "+n.url)):w("Don't display "+n.widgetType+" when no referral on widget rule match "+n.url))}),s.conversionUrls&&s.conversionUrls.forEach(function(n){t.user.referredBy&&e.matchesUrl(n)&&w("This is a conversion URL",n)}),s.fuelTankAutofillUrls&&(w("We found a fuel tank autofill!"),s.fuelTankAutofillUrls.forEach(function(n){if(e.matchesUrl(n.url)&&(w("Fuel Tank URL matches"),t.user.referredBy&&t.user.referredBy.code)){var r=document.querySelector(n.formSelector);r?r.value=t.user.referredBy.referredReward.fuelTankCode||"":w(new Error("Element with id/class "+n.formSelector+" was not found."))}})),o||"EMBED"!==n.engagementMedium)if(o||"POPUP"!==n.engagementMedium)if(o){w("display CTA");var u=s.cta.content.buttonSide,c=s.cta.content.buttonPosition;r=new b.default(a,{side:u,position:c}),r.load(),i&&r.open()}else w("display popup on load"),r=new y.default(a),r.load(),i&&r.open();else r=new y.default(a),r.load(),i&&r.open();else r=new m.default(a),r.load();return r}}],[{key:"renderErrorWidget",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"POPUP";w(new Error(e.apiErrorCode+" ("+e.rsCode+") "+e.message));var n=void 0,r={content:"error",rsCode:e.rsCode,type:"ERROR_WIDGET"};"EMBED"===t?n=new m.default(r):"POPUP"===t&&(n=new y.default(r)),n.load()}},{key:"matchesUrl",value:function(e){return window.location.href.match(new RegExp(e))}},{key:"cb",value:function(e,t,n){var r=void 0;r="string"==typeof n||n instanceof String?{email:n}:n,t.reload(r)}}]),e}();t.default=_},function(e,t,n){(function(t,r){!function(t,n){e.exports=n()}(this,function(){"use strict";function e(e){return"function"==typeof e||"object"==typeof e&&null!==e}function i(e){return"function"==typeof e}function o(e){G=e}function s(e){X=e}function a(){return function(){return t.nextTick(f)}}function u(){return function(){V(f)}}function c(){var e=0,t=new Q(f),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function l(){var e=new MessageChannel;return e.port1.onmessage=f,function(){return e.port2.postMessage(0)}}function h(){var e=setTimeout;return function(){return e(f,1)}}function f(){for(var e=0;e<J;e+=2){var t=ne[e],n=ne[e+1];t(n),ne[e]=void 0,ne[e+1]=void 0}J=0}function d(){try{var e=n(9);return V=e.runOnLoop||e.runOnContext,u()}catch(e){return h()}}function p(e,t){var n=arguments,r=this,i=new this.constructor(v);void 0===i[ie]&&q(i);var o=r._state;return o?!function(){var e=n[o-1];X(function(){return M(o,i,e,r._result)})}():k(r,i,e,t),i}function m(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(v);return O(n,e),n}function v(){}function y(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function b(e){try{return e.then}catch(e){return ue.error=e,ue}}function w(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}function _(e,t,n){X(function(e){var r=!1,i=w(n,t,function(n){r||(r=!0,t!==n?O(e,n):j(e,n))},function(t){r||(r=!0,C(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&i&&(r=!0,C(e,i))},e)}function E(e,t){t._state===se?j(e,t._result):t._state===ae?C(e,t._result):k(t,void 0,function(t){return O(e,t)},function(t){return C(e,t)})}function x(e,t,n){t.constructor===e.constructor&&n===p&&t.constructor.resolve===m?E(e,t):n===ue?C(e,ue.error):void 0===n?j(e,t):i(n)?_(e,t,n):j(e,t)}function O(t,n){t===n?C(t,y()):e(n)?x(t,n,b(n)):j(t,n)}function A(e){e._onerror&&e._onerror(e._result),P(e)}function j(e,t){e._state===oe&&(e._result=t,e._state=se,0!==e._subscribers.length&&X(P,e))}function C(e,t){e._state===oe&&(e._state=ae,e._result=t,X(A,e))}function k(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+se]=n,i[o+ae]=r,0===o&&e._state&&X(P,e)}function P(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,o=e._result,s=0;s<t.length;s+=3)r=t[s],i=t[s+n],r?M(n,r,i,o):i(o);e._subscribers.length=0}}function T(){this.error=null}function S(e,t){try{return e(t)}catch(e){return ce.error=e,ce}}function M(e,t,n,r){var o=i(n),s=void 0,a=void 0,u=void 0,c=void 0;if(o){if(s=S(n,r),s===ce?(c=!0,a=s.error,s=null):u=!0,t===s)return void C(t,g())}else s=r,u=!0;t._state!==oe||(o&&u?O(t,s):c?C(t,a):e===se?j(t,s):e===ae&&C(t,s))}function R(e,t){try{t(function(t){O(e,t)},function(t){C(e,t)})}catch(t){C(e,t)}}function I(){return le++}function q(e){e[ie]=le++,e._state=void 0,e._result=void 0,e._subscribers=[]}function U(e,t){this._instanceConstructor=e,this.promise=new e(v),this.promise[ie]||q(this.promise),Z(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?j(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&j(this.promise,this._result))):C(this.promise,F())}function F(){return new Error("Array Methods must be provided an Array")}function L(e){return new U(this,e).promise}function N(e){var t=this;return new t(Z(e)?function(n,r){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function z(e){var t=this,n=new t(v);return C(n,e),n}function D(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function W(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function $(e){this[ie]=I(),this._result=this._state=void 0,this._subscribers=[],v!==e&&("function"!=typeof e&&D(),this instanceof $?R(this,e):W())}function H(){var e=void 0;if("undefined"!=typeof r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=$}var B=void 0;B=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var Z=B,J=0,V=void 0,G=void 0,X=function(e,t){ne[J]=e,ne[J+1]=t,J+=2,2===J&&(G?G(f):re())},Y="undefined"!=typeof window?window:void 0,K=Y||{},Q=K.MutationObserver||K.WebKitMutationObserver,ee="undefined"==typeof self&&"undefined"!=typeof t&&"[object process]"==={}.toString.call(t),te="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ne=new Array(1e3),re=void 0;re=ee?a():Q?c():te?l():void 0===Y?d():h();var ie=Math.random().toString(36).substring(16),oe=void 0,se=1,ae=2,ue=new T,ce=new T,le=0;return U.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===oe&&n<e;n++)this._eachEntry(t[n],n)},U.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===m){var i=b(e);if(i===p&&e._state!==oe)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===$){var o=new n(v);x(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},U.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===oe&&(this._remaining--,e===ae?C(r,n):this._result[t]=n),0===this._remaining&&j(r,this._result)},U.prototype._willSettleAt=function(e,t){var n=this;k(e,void 0,function(e){return n._settledAt(se,t,e)},function(e){return n._settledAt(ae,t,e)})},$.all=L,$.race=N,$.resolve=m,$.reject=z,$._setScheduler=o,$._setAsap=s,$._asap=X,$.prototype={constructor:$,then:p,catch:function(e){return this.then(null,e)}},H(),$.polyfill=H,$.Promise=$,$})}).call(t,n(4),function(){return this}())},function(e,t){},function(e,t,n){!function(t,n){e.exports=n()}(this,function(){var e={};e=function(){this.listeners={}},e.prototype={addEventListener:function(e,t,n){for(var r=[],i=arguments.length,o=0;o<i;o++)r.push(arguments[o]);r=r.length>3?r.splice(3,r.length-1):[],"undefined"!=typeof this.listeners[e]?this.listeners[e].push({scope:n,callback:t,args:r}):this.listeners[e]=[{scope:n,callback:t,args:r}]},removeEventListener:function(e,t,n){if("undefined"!=typeof this.listeners[e]){for(var r=this.listeners[e].length,i=[],o=0;o<r;o++){var s=this.listeners[e][o];s.scope==n&&s.callback==t||i.push(s)}this.listeners[e]=i}},hasEventListener:function(e,t,n){if("undefined"!=typeof this.listeners[e]){var r=this.listeners[e].length;if(void 0===t&&void 0===n)return r>0;for(var i=0;i<r;i++){var o=this.listeners[e][i];if((!n||o.scope==n)&&o.callback==t)return!0}}return!1},dispatch:function(e,t){for(var n=0,r={type:e,target:t},i=[],o=arguments.length,s=0;s<o;s++)i.push(arguments[s]);if(i=i.length>2?i.splice(2,i.length-1):[],i=[r].concat(i),"undefined"!=typeof this.listeners[e])for(var a=this.listeners[e].length,s=0;s<a;s++){var u=this.listeners[e][s];if(u&&u.callback){var c=i.concat(u.args);u.callback.apply(u.scope,c),n+=1}}},getEvents:function(){var e="";for(var t in this.listeners)for(var n=this.listeners[t].length,r=0;r<n;r++){var i=this.listeners[t][r];e+=i.scope&&i.scope.className?i.scope.className:"anonymous",e+=" listen for '"+t+"'\n"}return e}};var t=new e;return t})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(12),a=r(s),u=n(8),c=r(u),l=n(17);n(28);var h=n(29),f=r(h),d=function(){function e(t){if(i(this,e),!t.tenantAlias)throw new Error("tenantAlias not provided");this.tenantAlias=t.tenantAlias,this.domain=t.domain||"https://app.referralsaasquatch.com"}return o(e,[{key:"cookieUser",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{widgetType:"",engagementMedium:"",jwt:""};e.validateInput(t,f.default.cookieUser);var n=encodeURIComponent(this.tenantAlias),r=t.widgetType?"?widgetType="+encodeURIComponent(t.widgetType):"",i=t.engagementMedium?(r?"&":"?")+"engagementMedium="+encodeURIComponent(t.engagementMedium):(r?"&":"?")+"engagementMedium=POPUP",o=r+i,s="/api/v1/"+n+"/widget/user/cookie_user"+o,a=this.domain+s;return e.doPut(a,JSON.stringify(t.user?t.user:{}),t.jwt)}},{key:"upsertUser",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{widgetType:"",engagementMedium:"",jwt:""};e.validateInput(t,f.default.upsertUser);var n=encodeURIComponent(this.tenantAlias),r=encodeURIComponent(t.user.accountId),i=encodeURIComponent(t.user.id),o=t.widgetType?"?widgetType="+encodeURIComponent(t.widgetType):"",s=t.engagementMedium?(o?"&":"?")+"engagementMedium="+encodeURIComponent(t.engagementMedium):(o?"&":"?")+"engagementMedium=POPUP",a=o+s,u="/api/v1/"+n+"/widget/account/"+r+"/user/"+i+"/upsert"+a,c=this.domain+u;return e.doPut(c,JSON.stringify(t.user),t.jwt)}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{widgetType:"",engagementMedium:"",jwt:""};e.validateInput(t,f.default.upsertUser);var n=encodeURIComponent(this.tenantAlias),r=encodeURIComponent(t.user.accountId),i=encodeURIComponent(t.user.id),o=t.widgetType?"?widgetType="+encodeURIComponent(t.widgetType):"",s=t.engagementMedium?(o?"&":"?")+"engagementMedium="+encodeURIComponent(t.engagementMedium):(o?"&":"?")+"engagementMedium=POPUP",a=o+s,u="/api/v1/"+n+"/widget/account/"+r+"/user/"+i+"/render"+a,c=this.domain+u;return e.doRequest(c,t.jwt)}},{key:"invite",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emailList:[]},n=encodeURIComponent(t.tenantAlias),r="/api/v1/"+n+"/mail/referralinvite",i=this.domain+r,o={sendingAccountId:t.accountId,sendingUserId:t.userId,recipients:t.emailList};return e.doPost(i,JSON.stringify(o))}},{key:"squatchReferralCookie",value:function(){var t=encodeURIComponent(this.tenantAlias),n=this.domain+"/a/"+t+"/widgets/squatchcookiejson";return e.doRequest(n)}}],[{key:"validateInput",value:function(e,t){var n=(0,l.validate)(e,t);if(!n.valid)throw n.errors}},{key:"doRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={Accept:"application/json","Content-Type":"application/json"};return t&&(n["X-SaaSquatch-User-Token"]=t),a.default.get(e).withCredentials().set(n).then(function(e){return e.headers["content-type"]&&e.headers["content-type"].toLowerCase().includes("application/json")?JSON.parse(e.text):e.text},function(e){var t=JSON.parse(e.response.text);return c.default.reject(t)})}},{key:"doPut",value:function(e,t,n){var r={Accept:"application/json","Content-Type":"application/json","X-SaaSquatch-Referrer":window?window.location.href:""};return n&&(r["X-SaaSquatch-User-Token"]=n),a.default.put(e).withCredentials().send(t).set(r).then(function(e){return JSON.parse(e.text)},function(e){var t=void 0;try{t=JSON.parse(e.response.text)}catch(t){return c.default.reject(e||t)}return c.default.reject(t)})}},{key:"doPost",value:function(e,t){var n={Accept:"application/json","Content-Type":"application/json"};return a.default.post(e).send(t).set(n).then(function(e){return e.text})}}]),e}();t.default=d},function(e,t,n){function r(){}function i(e){if(!y(e))return e;var t=[];for(var n in e)o(t,n,e[n]);return t.join("&")}function o(e,t,n){if(null!=n)if(Array.isArray(n))n.forEach(function(n){o(e,t,n)});else if(y(n))for(var r in n)o(e,t+"["+r+"]",n[r]);else e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));else null===n&&e.push(encodeURIComponent(t))}function s(e){for(var t,n,r={},i=e.split("&"),o=0,s=i.length;o<s;++o)t=i[o],n=t.indexOf("="),n==-1?r[decodeURIComponent(t)]="":r[decodeURIComponent(t.slice(0,n))]=decodeURIComponent(t.slice(n+1));return r}function a(e){var t,n,r,i,o=e.split(/\r?\n/),s={};o.pop();for(var a=0,u=o.length;a<u;++a)n=o[a],t=n.indexOf(":"),r=n.slice(0,t).toLowerCase(),i=b(n.slice(t+1)),s[r]=i;return s}function u(e){return/[\/+]json\b/.test(e)}function c(e){return e.split(/ *; */).shift()}function l(e){return e.split(/ *; */).reduce(function(e,t){var n=t.split(/ *= */),r=n.shift(),i=n.shift();return r&&i&&(e[r]=i),e},{})}function h(e,t){t=t||{},this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||"undefined"==typeof this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this._setStatusProperties(this.xhr.status),this.header=this.headers=a(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function f(e,t){var n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",function(){var e=null,t=null;try{t=new h(n)}catch(t){return e=new Error("Parser is unable to parse the response"),e.parse=!0,e.original=t,e.rawResponse=n.xhr&&n.xhr.responseText?n.xhr.responseText:null,e.statusCode=n.xhr&&n.xhr.status?n.xhr.status:null,n.callback(e)}n.emit("response",t);var r;try{(t.status<200||t.status>=300)&&(r=new Error(t.statusText||"Unsuccessful HTTP response"),r.original=e,r.response=t,r.status=t.status)}catch(e){r=e}r?n.callback(r,t):n.callback(null,t)})}function d(e,t){var n=g("DELETE",e);return t&&n.end(t),n}var p;"undefined"!=typeof window?p=window:"undefined"!=typeof self?p=self:(console.warn("Using browser-only version of superagent in non-browser environment"),p=this);var m=n(13),v=n(14),y=n(15),g=e.exports=n(16).bind(null,f);g.getXHR=function(){if(!(!p.XMLHttpRequest||p.location&&"file:"==p.location.protocol&&p.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw Error("Browser-only verison of superagent could not find XHR")};var b="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};g.serializeObject=i,g.parseString=s,g.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},g.serialize={"application/x-www-form-urlencoded":i,"application/json":JSON.stringify},g.parse={"application/x-www-form-urlencoded":s,"application/json":JSON.parse},h.prototype.get=function(e){return this.header[e.toLowerCase()]},h.prototype._setHeaderProperties=function(e){var t=this.header["content-type"]||"";this.type=c(t);var n=l(t);for(var r in n)this[r]=n[r]},h.prototype._parseBody=function(e){var t=g.parse[this.type];return!t&&u(this.type)&&(t=g.parse["application/json"]),t&&e&&(e.length||e instanceof Object)?t(e):null},h.prototype._setStatusProperties=function(e){1223===e&&(e=204);var t=e/100|0;this.status=this.statusCode=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.accepted=202==e,this.noContent=204==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.notFound=404==e,this.forbidden=403==e},h.prototype.toError=function(){var e=this.req,t=e.method,n=e.url,r="cannot "+t+" "+n+" ("+this.status+")",i=new Error(r);return i.status=this.status,i.method=t,i.url=n,i},g.Response=h,m(f.prototype);for(var w in v)f.prototype[w]=v[w];f.prototype.type=function(e){return this.set("Content-Type",g.types[e]||e),this},f.prototype.responseType=function(e){return this._responseType=e,this},f.prototype.accept=function(e){return this.set("Accept",g.types[e]||e),this},f.prototype.auth=function(e,t,n){switch(n||(n={type:"basic"}),n.type){case"basic":var r=btoa(e+":"+t);this.set("Authorization","Basic "+r);break;case"auto":this.username=e,this.password=t}return this},f.prototype.query=function(e){return"string"!=typeof e&&(e=i(e)),e&&this._query.push(e),this},f.prototype.attach=function(e,t,n){return this._getFormData().append(e,t,n||t.name),this},f.prototype._getFormData=function(){return this._formData||(this._formData=new p.FormData),this._formData},f.prototype.callback=function(e,t){var n=this._callback;this.clearTimeout(),n(e,t)},f.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},f.prototype._timeoutError=function(){var e=this._timeout,t=new Error("timeout of "+e+"ms exceeded");t.timeout=e,this.callback(t)},f.prototype._appendQueryString=function(){var e=this._query.join("&");e&&(this.url+=~this.url.indexOf("?")?"&"+e:"?"+e)},f.prototype.end=function(e){var t=this,n=this.xhr=g.getXHR(),i=this._timeout,o=this._formData||this._data;this._callback=e||r,n.onreadystatechange=function(){if(4==n.readyState){var e;try{e=n.status}catch(t){e=0}if(0==e){if(t.timedout)return t._timeoutError();if(t._aborted)return;return t.crossDomainError()}t.emit("end")}};var s=function(e,n){n.total>0&&(n.percent=n.loaded/n.total*100),n.direction=e,t.emit("progress",n)};if(this.hasListeners("progress"))try{n.onprogress=s.bind(null,"download"),n.upload&&(n.upload.onprogress=s.bind(null,"upload"))}catch(e){}if(i&&!this._timer&&(this._timer=setTimeout(function(){t.timedout=!0,t.abort()},i)),this._appendQueryString(),this.username&&this.password?n.open(this.method,this.url,!0,this.username,this.password):n.open(this.method,this.url,!0),this._withCredentials&&(n.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof o&&!this._isHost(o)){var a=this._header["content-type"],c=this._serializer||g.serialize[a?a.split(";")[0]:""];!c&&u(a)&&(c=g.serialize["application/json"]),c&&(o=c(o))}for(var l in this.header)null!=this.header[l]&&n.setRequestHeader(l,this.header[l]);return this._responseType&&(n.responseType=this._responseType),this.emit("request",this),n.send("undefined"!=typeof o?o:null),this},g.Request=f,g.get=function(e,t,n){var r=g("GET",e);return"function"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},g.head=function(e,t,n){var r=g("HEAD",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},g.options=function(e,t,n){var r=g("OPTIONS",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},g.del=d,g.delete=d,g.patch=function(e,t,n){var r=g("PATCH",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},g.post=function(e,t,n){var r=g("POST",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},g.put=function(e,t,n){var r=g("PUT",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}},function(e,t,n){function r(e){if(e)return i(e)}function i(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),
this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===t||r.fn===t){n.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){var r=n(15);t.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},t.parse=function(e){return this._parser=e,this},t.serialize=function(e){return this._serializer=e,this},t.timeout=function(e){return this._timeout=e,this},t.then=function(e,t){if(!this._fullfilledPromise){var n=this;this._fullfilledPromise=new Promise(function(e,t){n.end(function(n,r){n?t(n):e(r)})})}return this._fullfilledPromise.then(e,t)},t.catch=function(e){return this.then(void 0,e)},t.use=function(e){return e(this),this},t.get=function(e){return this._header[e.toLowerCase()]},t.getHeader=t.get,t.set=function(e,t){if(r(e)){for(var n in e)this.set(n,e[n]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},t.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},t.field=function(e,t){if(null===e||void 0===e)throw new Error(".field(name, val) name can not be empty");if(r(e)){for(var n in e)this.field(n,e[n]);return this}if(null===t||void 0===t)throw new Error(".field(name, val) val can not be empty");return this._getFormData().append(e,t),this},t.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},t.withCredentials=function(){return this._withCredentials=!0,this},t.redirects=function(e){return this._maxRedirects=e,this},t.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},t._isHost=function(e){var t={}.toString.call(e);switch(t){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}},t.send=function(e){var t=r(e),n=this._header["content-type"];if(t&&r(this._data))for(var i in e)this._data[i]=e[i];else"string"==typeof e?(n||this.type("form"),n=this._header["content-type"],"application/x-www-form-urlencoded"==n?this._data=this._data?this._data+"&"+e:e:this._data=(this._data||"")+e):this._data=e;return!t||this._isHost(e)?this:(n||this.type("json"),this)}},function(e,t){function n(e){return null!==e&&"object"==typeof e}e.exports=n},function(e,t){function n(e,t,n){return"function"==typeof n?new e("GET",t).end(n):2==arguments.length?new e("GET",t):new e(t,n)}e.exports=n},function(e,t,n){"use strict";var r=e.exports.Validator=n(18);e.exports.ValidatorResult=n(26).ValidatorResult,e.exports.ValidationError=n(26).ValidationError,e.exports.SchemaError=n(26).SchemaError,e.exports.SchemaScanResult=n(27).SchemaScanResult,e.exports.scan=n(27).scan,e.exports.validate=function(e,t,n){var i=new r;return i.validate(e,t,n)}},function(e,t,n){"use strict";function r(e){var t="string"==typeof e?e:e.$ref;return"string"==typeof t&&t}var i=n(19),o=n(25),s=n(26),a=n(27).scan,u=s.ValidatorResult,c=s.SchemaError,l=s.SchemaContext,h="/",f=function e(){this.customFormats=Object.create(e.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(d),this.attributes=Object.create(o.validators)};f.prototype.customFormats={},f.prototype.schemas=null,f.prototype.types=null,f.prototype.attributes=null,f.prototype.unresolvedRefs=null,f.prototype.addSchema=function(e,t){var n=this;if(!e)return null;var r=a(t||h,e),i=t||e.id;for(var o in r.id)this.schemas[o]=r.id[o];for(var o in r.ref)this.unresolvedRefs.push(o);return this.unresolvedRefs=this.unresolvedRefs.filter(function(e){return"undefined"==typeof n.schemas[e]}),this.schemas[i]},f.prototype.addSubSchemaArray=function(e,t){if(t instanceof Array)for(var n=0;n<t.length;n++)this.addSubSchema(e,t[n])},f.prototype.addSubSchemaObject=function(e,t){if(t&&"object"==typeof t)for(var n in t)this.addSubSchema(e,t[n])},f.prototype.setSchemas=function(e){this.schemas=e},f.prototype.getSchema=function(e){return this.schemas[e]},f.prototype.validate=function(e,t,n,r){n||(n={});var o=n.propertyName||"instance",s=i.resolve(n.base||h,t.id||"");if(!r){r=new l(t,n,o,s,Object.create(this.schemas)),r.schemas[s]||(r.schemas[s]=t);var u=a(s,t);for(var f in u.id){var d=u.id[f];r.schemas[f]=d}}if(t){var p=this.validateSchema(e,t,n,r);if(!p)throw new Error("Result undefined");return p}throw new c("no schema specified",t)},f.prototype.validateSchema=function(e,t,n,i){var a=new u(e,t,n,i);if("boolean"==typeof t)t===!0?t={}:t===!1&&(t={type:[]});else if(!t)throw new Error("schema is undefined");if(t.extends)if(t.extends instanceof Array){var h={schema:t,ctx:i};t.extends.forEach(this.schemaTraverser.bind(this,h)),t=h.schema,h.schema=null,h.ctx=null,h=null}else t=s.deepMerge(t,this.superResolve(t.extends,i));var f;if(f=r(t)){var d=this.resolve(t,f,i),p=new l(d.subschema,n,i.propertyPath,d.switchSchema,i.schemas);return this.validateSchema(e,d.subschema,n,p)}var m=n&&n.skipAttributes||[];for(var v in t)if(!o.ignoreProperties[v]&&m.indexOf(v)<0){var y=null,g=this.attributes[v];if(g)y=g.call(this,e,t,n,i);else if(n.allowUnknownAttributes===!1)throw new c("Unsupported attribute: "+v,t);y&&a.importErrors(y)}if("function"==typeof n.rewrite){var b=n.rewrite.call(this,e,t,n,i);a.instance=b}return a},f.prototype.schemaTraverser=function(e,t){e.schema=s.deepMerge(e.schema,this.superResolve(t,e.ctx))},f.prototype.superResolve=function(e,t){var n;return(n=r(e))?this.resolve(e,n,t).subschema:e},f.prototype.resolve=function(e,t,n){if(t=n.resolve(t),n.schemas[t])return{subschema:n.schemas[t],switchSchema:t};var r=i.parse(t),o=r&&r.hash,a=o&&o.length&&t.substr(0,t.length-o.length);if(!a||!n.schemas[a])throw new c("no such schema <"+t+">",e);var u=s.objectGetPath(n.schemas[a],o.substr(1));if(void 0===u)throw new c("no such schema "+o+" located in <"+a+">",e);return{subschema:u,switchSchema:t}},f.prototype.testType=function(e,t,n,r,i){if("function"==typeof this.types[i])return this.types[i].call(this,e);if(i&&"object"==typeof i){var o=this.validateSchema(e,i,n,r);return void 0===o||!(o&&o.errors.length)}return!0};var d=f.prototype.types={};d.string=function(e){return"string"==typeof e},d.number=function(e){return"number"==typeof e&&isFinite(e)},d.integer=function(e){return"number"==typeof e&&e%1===0},d.boolean=function(e){return"boolean"==typeof e},d.array=function(e){return Array.isArray(e)},d.null=function(e){return null===e},d.date=function(e){return e instanceof Date},d.any=function(e){return!0},d.object=function(e){return e&&"object"==typeof e&&!(e instanceof Array)&&!(e instanceof Date)},e.exports=f},function(e,t,n){function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(e,t,n){if(e&&c(e)&&e instanceof r)return e;var i=new r;return i.parse(e,t,n),i}function o(e){return u(e)&&(e=i(e)),e instanceof r?e.format():r.prototype.format.call(e)}function s(e,t){return i(e,!1,!0).resolve(t)}function a(e,t){return e?i(e,!1,!0).resolveObject(t):t}function u(e){return"string"==typeof e}function c(e){return"object"==typeof e&&null!==e}function l(e){return null===e}function h(e){return null==e}var f=n(20);t.parse=i,t.resolve=s,t.resolveObject=a,t.format=o,t.Url=r;var d=/^([a-z0-9.+-]+:)/i,p=/:[0-9]*$/,m=["<",">",'"',"`"," ","\r","\n","\t"],v=["{","}","|","\\","^","`"].concat(m),y=["'"].concat(v),g=["%","/","?",";","#"].concat(y),b=["/","?","#"],w=255,_=/^[a-z0-9A-Z_-]{0,63}$/,E=/^([a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},O={javascript:!0,"javascript:":!0},A={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},j=n(22);r.prototype.parse=function(e,t,n){if(!u(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e;r=r.trim();var i=d.exec(r);if(i){i=i[0];var o=i.toLowerCase();this.protocol=o,r=r.substr(i.length)}if(n||i||r.match(/^\/\/[^@\/]+@[^@\/]+/)){var s="//"===r.substr(0,2);!s||i&&O[i]||(r=r.substr(2),this.slashes=!0)}if(!O[i]&&(s||i&&!A[i])){for(var a=-1,c=0;c<b.length;c++){var l=r.indexOf(b[c]);l!==-1&&(a===-1||l<a)&&(a=l)}var h,p;p=a===-1?r.lastIndexOf("@"):r.lastIndexOf("@",a),p!==-1&&(h=r.slice(0,p),r=r.slice(p+1),this.auth=decodeURIComponent(h)),a=-1;for(var c=0;c<g.length;c++){var l=r.indexOf(g[c]);l!==-1&&(a===-1||l<a)&&(a=l)}a===-1&&(a=r.length),this.host=r.slice(0,a),r=r.slice(a),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var v=this.hostname.split(/\./),c=0,C=v.length;c<C;c++){var k=v[c];if(k&&!k.match(_)){for(var P="",T=0,S=k.length;T<S;T++)P+=k.charCodeAt(T)>127?"x":k[T];if(!P.match(_)){var M=v.slice(0,c),R=v.slice(c+1),I=k.match(E);I&&(M.push(I[1]),R.unshift(I[2])),R.length&&(r="/"+R.join(".")+r),this.hostname=M.join(".");break}}}if(this.hostname.length>w?this.hostname="":this.hostname=this.hostname.toLowerCase(),!m){for(var q=this.hostname.split("."),U=[],c=0;c<q.length;++c){var F=q[c];U.push(F.match(/[^A-Za-z0-9_-]/)?"xn--"+f.encode(F):F)}this.hostname=U.join(".")}var L=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+L,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==r[0]&&(r="/"+r))}if(!x[o])for(var c=0,C=y.length;c<C;c++){var z=y[c],D=encodeURIComponent(z);D===z&&(D=escape(z)),r=r.split(z).join(D)}var W=r.indexOf("#");W!==-1&&(this.hash=r.substr(W),r=r.slice(0,W));var $=r.indexOf("?");if($!==-1?(this.search=r.substr($),this.query=r.substr($+1),t&&(this.query=j.parse(this.query)),r=r.slice(0,$)):t&&(this.search="",this.query={}),r&&(this.pathname=r),A[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var L=this.pathname||"",F=this.search||"";this.path=L+F}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&c(this.query)&&Object.keys(this.query).length&&(o=j.stringify(this.query));var s=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||A[t])&&i!==!1?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace("#","%23"),t+i+n+s+r},r.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(u(e)){var t=new r;t.parse(e,!1,!0),e=t}var n=new r;if(Object.keys(this).forEach(function(e){n[e]=this[e]},this),n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol)return Object.keys(e).forEach(function(t){"protocol"!==t&&(n[t]=e[t])}),A[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n;if(e.protocol&&e.protocol!==n.protocol){if(!A[e.protocol])return Object.keys(e).forEach(function(t){n[t]=e[t]}),n.href=n.format(),n;if(n.protocol=e.protocol,e.host||O[e.protocol])n.pathname=e.pathname;else{for(var i=(e.pathname||"").split("/");i.length&&!(e.host=i.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==i[0]&&i.unshift(""),i.length<2&&i.unshift(""),n.pathname=i.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var o=n.pathname||"",s=n.search||"";n.path=o+s}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var a=n.pathname&&"/"===n.pathname.charAt(0),c=e.host||e.pathname&&"/"===e.pathname.charAt(0),f=c||a||n.host&&e.pathname,d=f,p=n.pathname&&n.pathname.split("/")||[],i=e.pathname&&e.pathname.split("/")||[],m=n.protocol&&!A[n.protocol];if(m&&(n.hostname="",n.port=null,n.host&&(""===p[0]?p[0]=n.host:p.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===i[0]?i[0]=e.host:i.unshift(e.host)),e.host=null),f=f&&(""===i[0]||""===p[0])),c)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,p=i;else if(i.length)p||(p=[]),p.pop(),p=p.concat(i),n.search=e.search,n.query=e.query;else if(!h(e.search)){if(m){n.hostname=n.host=p.shift();var v=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");v&&(n.auth=v.shift(),n.host=n.hostname=v.shift())}return n.search=e.search,n.query=e.query,l(n.pathname)&&l(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!p.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var y=p.slice(-1)[0],g=(n.host||e.host)&&("."===y||".."===y)||""===y,b=0,w=p.length;w>=0;w--)y=p[w],"."==y?p.splice(w,1):".."===y?(p.splice(w,1),b++):b&&(p.splice(w,1),b--);if(!f&&!d)for(;b--;b)p.unshift("..");!f||""===p[0]||p[0]&&"/"===p[0].charAt(0)||p.unshift(""),g&&"/"!==p.join("/").substr(-1)&&p.push("");var _=""===p[0]||p[0]&&"/"===p[0].charAt(0);if(m){n.hostname=n.host=_?"":p.length?p.shift():"";var v=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");v&&(n.auth=v.shift(),n.host=n.hostname=v.shift())}return f=f||n.host&&p.length,f&&!_&&p.unshift(""),p.length?n.pathname=p.join("/"):(n.pathname=null,n.path=null),l(n.pathname)&&l(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=p.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){var r;(function(e,i){!function(o){function s(e){throw RangeError(M[e])}function a(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function u(e,t){var n=e.split("@"),r="";n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(S,".");var i=e.split("."),o=a(i,t).join(".");return r+o}function c(e){for(var t,n,r=[],i=0,o=e.length;i<o;)t=e.charCodeAt(i++),t>=55296&&t<=56319&&i<o?(n=e.charCodeAt(i++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--)):r.push(t);return r}function l(e){return a(e,function(e){var t="";return e>65535&&(e-=65536,t+=q(e>>>10&1023|55296),e=56320|1023&e),t+=q(e)}).join("")}function h(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:_}function f(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function d(e,t,n){var r=0;for(e=n?I(e/A):e>>1,e+=I(e/t);e>R*x>>1;r+=_)e=I(e/R);return I(r+(R+1)*e/(e+O))}function p(e){var t,n,r,i,o,a,u,c,f,p,m=[],v=e.length,y=0,g=C,b=j;for(n=e.lastIndexOf(k),n<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&s("not-basic"),m.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<v;){for(o=y,a=1,u=_;i>=v&&s("invalid-input"),c=h(e.charCodeAt(i++)),(c>=_||c>I((w-y)/a))&&s("overflow"),y+=c*a,f=u<=b?E:u>=b+x?x:u-b,!(c<f);u+=_)p=_-f,a>I(w/p)&&s("overflow"),a*=p;t=m.length+1,b=d(y-o,t,0==o),I(y/t)>w-g&&s("overflow"),g+=I(y/t),y%=t,m.splice(y++,0,g)}return l(m)}function m(e){var t,n,r,i,o,a,u,l,h,p,m,v,y,g,b,O=[];for(e=c(e),v=e.length,t=C,n=0,o=j,a=0;a<v;++a)m=e[a],m<128&&O.push(q(m));for(r=i=O.length,i&&O.push(k);r<v;){for(u=w,a=0;a<v;++a)m=e[a],m>=t&&m<u&&(u=m);for(y=r+1,u-t>I((w-n)/y)&&s("overflow"),n+=(u-t)*y,t=u,a=0;a<v;++a)if(m=e[a],m<t&&++n>w&&s("overflow"),m==t){for(l=n,h=_;p=h<=o?E:h>=o+x?x:h-o,!(l<p);h+=_)b=l-p,g=_-p,O.push(q(f(p+b%g,0))),l=I(b/g);O.push(q(f(l,0))),o=d(n,y,r==i),n=0,++r}++n,++t}return O.join("")}function v(e){return u(e,function(e){return P.test(e)?p(e.slice(4).toLowerCase()):e})}function y(e){return u(e,function(e){return T.test(e)?"xn--"+m(e):e})}var g=("object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof i&&i);g.global!==g&&g.window!==g&&g.self!==g||(o=g);var b,w=2147483647,_=36,E=1,x=26,O=38,A=700,j=72,C=128,k="-",P=/^xn--/,T=/[^\x20-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,M={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},R=_-E,I=Math.floor,q=String.fromCharCode;b={version:"1.3.2",ucs2:{decode:c,encode:l},decode:p,encode:m,toASCII:y,toUnicode:v},r=function(){return b}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))}(this)}).call(t,n(21)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,n){"use strict";t.decode=t.parse=n(23),t.encode=t.stringify=n(24)},function(e,t){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,i){t=t||"&",r=r||"=";var o={};if("string"!=typeof e||0===e.length)return o;var s=/\+/g;e=e.split(t);var a=1e3;i&&"number"==typeof i.maxKeys&&(a=i.maxKeys);var u=e.length;a>0&&u>a&&(u=a);for(var c=0;c<u;++c){var l,h,f,d,p=e[c].replace(s,"%20"),m=p.indexOf(r);m>=0?(l=p.substr(0,m),h=p.substr(m+1)):(l=p,h=""),f=decodeURIComponent(l),d=decodeURIComponent(h),n(o,f)?Array.isArray(o[f])?o[f].push(d):o[f]=[o[f],d]:o[f]=d}return o}},function(e,t){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,i){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map(function(i){var o=encodeURIComponent(n(i))+r;return Array.isArray(e[i])?e[i].map(function(e){return o+encodeURIComponent(n(e))}).join(t):o+encodeURIComponent(n(e[i]))}).join(t):i?encodeURIComponent(n(i))+r+encodeURIComponent(n(e)):""}},function(e,t,n){"use strict";function r(e,t,n,r,i){var o=t.throwError;t.throwError=!1;var s=this.validateSchema(e,i,t,n);return t.throwError=o,!s.valid&&r instanceof Function&&r(s),s.valid}function i(e,t,n,r,i,o){if(this.types.object(e)&&(!t.properties||void 0===t.properties[i]))if(t.additionalProperties===!1)o.addError({name:"additionalProperties",argument:i,message:"additionalProperty "+JSON.stringify(i)+" exists in instance when not allowed"});else{var s=t.additionalProperties||{};"function"==typeof n.preValidateProperty&&n.preValidateProperty(e,i,s,n,r);var a=this.validateSchema(e[i],s,n,r.makeChild(s,i));a.instance!==o.instance[i]&&(o.instance[i]=a.instance),o.importErrors(a)}}function o(e,t,n){var r,i=n.length;for(r=t+1,i;r<i;r++)if(s.deepCompareStrict(e,n[r]))return!1;return!0}var s=n(26),a=s.ValidatorResult,u=s.SchemaError,c={};c.ignoreProperties={id:!0,default:!0,description:!0,title:!0,exclusiveMinimum:!0,exclusiveMaximum:!0,additionalItems:!0,$schema:!0,$ref:!0,extends:!0};var l=c.validators={};l.type=function(e,t,n,r){if(void 0===e)return null;var i=new a(e,t,n,r),o=Array.isArray(t.type)?t.type:[t.type];if(!o.some(this.testType.bind(this,e,t,n,r))){var s=o.map(function(e){return e.id&&"<"+e.id+">"||e+""});i.addError({name:"type",argument:s,message:"is not of a type(s) "+s})}return i},l.anyOf=function(e,t,n,i){if(void 0===e)return null;var o=new a(e,t,n,i),s=new a(e,t,n,i);if(!Array.isArray(t.anyOf))throw new u("anyOf must be an array");if(!t.anyOf.some(r.bind(this,e,n,i,function(e){s.importErrors(e)}))){var c=t.anyOf.map(function(e,t){return e.id&&"<"+e.id+">"||e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"});n.nestedErrors&&o.importErrors(s),o.addError({name:"anyOf",argument:c,message:"is not any of "+c.join(",")})}return o},l.allOf=function(e,t,n,r){if(void 0===e)return null;if(!Array.isArray(t.allOf))throw new u("allOf must be an array");var i=new a(e,t,n,r),o=this;return t.allOf.forEach(function(t,s){var a=o.validateSchema(e,t,n,r);if(!a.valid){var u=t.id&&"<"+t.id+">"||t.title&&JSON.stringify(t.title)||t.$ref&&"<"+t.$ref+">"||"[subschema "+s+"]";i.addError({name:"allOf",argument:{id:u,length:a.errors.length,valid:a},message:"does not match allOf schema "+u+" with "+a.errors.length+" error[s]:"}),i.importErrors(a)}}),i},l.oneOf=function(e,t,n,i){if(void 0===e)return null;if(!Array.isArray(t.oneOf))throw new u("oneOf must be an array");var o=new a(e,t,n,i),s=new a(e,t,n,i),c=t.oneOf.filter(r.bind(this,e,n,i,function(e){s.importErrors(e)})).length,l=t.oneOf.map(function(e,t){return e.id&&"<"+e.id+">"||e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"});return 1!==c&&(n.nestedErrors&&o.importErrors(s),o.addError({name:"oneOf",argument:l,message:"is not exactly one from "+l.join(",")})),o},l.properties=function(e,t,n,r){if(this.types.object(e)){var i=new a(e,t,n,r),o=t.properties||{};for(var s in o){"function"==typeof n.preValidateProperty&&n.preValidateProperty(e,s,o[s],n,r);var u=Object.hasOwnProperty.call(e,s)?e[s]:void 0,c=this.validateSchema(u,o[s],n,r.makeChild(o[s],s));c.instance!==i.instance[s]&&(i.instance[s]=c.instance),i.importErrors(c)}return i}},l.patternProperties=function(e,t,n,r){if(this.types.object(e)){var o=new a(e,t,n,r),s=t.patternProperties||{};for(var u in e){var c=!0;for(var l in s){var h=new RegExp(l);if(h.test(u)){c=!1,"function"==typeof n.preValidateProperty&&n.preValidateProperty(e,u,s[l],n,r);var f=this.validateSchema(e[u],s[l],n,r.makeChild(s[l],u));f.instance!==o.instance[u]&&(o.instance[u]=f.instance),o.importErrors(f)}}c&&i.call(this,e,t,n,r,u,o)}return o}},l.additionalProperties=function(e,t,n,r){if(this.types.object(e)){if(t.patternProperties)return null;var o=new a(e,t,n,r);for(var s in e)i.call(this,e,t,n,r,s,o);return o}},l.minProperties=function(e,t,n,r){if(this.types.object(e)){var i=new a(e,t,n,r),o=Object.keys(e);return o.length>=t.minProperties||i.addError({name:"minProperties",argument:t.minProperties,message:"does not meet minimum property length of "+t.minProperties}),i}},l.maxProperties=function(e,t,n,r){if(this.types.object(e)){var i=new a(e,t,n,r),o=Object.keys(e);return o.length<=t.maxProperties||i.addError({name:"maxProperties",argument:t.maxProperties,message:"does not meet maximum property length of "+t.maxProperties}),i}},l.items=function(e,t,n,r){var i=this;if(this.types.array(e)&&t.items){var o=new a(e,t,n,r);return e.every(function(e,s){var a=Array.isArray(t.items)?t.items[s]||t.additionalItems:t.items;if(void 0===a)return!0;if(a===!1)return o.addError({name:"items",message:"additionalItems not permitted"}),!1;var u=i.validateSchema(e,a,n,r.makeChild(a,s));return u.instance!==o.instance[s]&&(o.instance[s]=u.instance),o.importErrors(u),!0}),o}},l.minimum=function(e,t,n,r){if(this.types.number(e)){var i=new a(e,t,n,r),o=!0;return o=t.exclusiveMinimum&&t.exclusiveMinimum===!0?e>t.minimum:e>=t.minimum,o||i.addError({name:"minimum",argument:t.minimum,message:"must have a minimum value of "+t.minimum}),i}},l.maximum=function(e,t,n,r){if(this.types.number(e)){var i,o=new a(e,t,n,r);return i=t.exclusiveMaximum&&t.exclusiveMaximum===!0?e<t.maximum:e<=t.maximum,i||o.addError({name:"maximum",argument:t.maximum,message:"must have a maximum value of "+t.maximum}),o}};var h=function(e,t,n,r,i,o){if(this.types.number(e)){var c=t[i];if(0==c)throw new u(i+" cannot be zero");var l=new a(e,t,n,r),h=s.getDecimalPlaces(e),f=s.getDecimalPlaces(c),d=Math.max(h,f),p=Math.pow(10,d);return Math.round(e*p)%Math.round(c*p)!==0&&l.addError({name:i,argument:c,message:o+JSON.stringify(c)}),l}};l.multipleOf=function(e,t,n,r){return h.call(this,e,t,n,r,"multipleOf","is not a multiple of (divisible by) ")},l.divisibleBy=function(e,t,n,r){return h.call(this,e,t,n,r,"divisibleBy","is not divisible by (multiple of) ")},l.required=function(e,t,n,r){var i=new a(e,t,n,r);return void 0===e&&t.required===!0?i.addError({name:"required",message:"is required"}):this.types.object(e)&&Array.isArray(t.required)&&t.required.forEach(function(t){void 0===e[t]&&i.addError({name:"required",argument:t,message:"requires property "+JSON.stringify(t)})}),i},l.pattern=function(e,t,n,r){if(this.types.string(e)){var i=new a(e,t,n,r);return e.match(t.pattern)||i.addError({name:"pattern",argument:t.pattern,message:"does not match pattern "+JSON.stringify(t.pattern)}),i}},l.format=function(e,t,n,r){if(void 0!==e){var i=new a(e,t,n,r);return i.disableFormat||s.isFormat(e,t.format,this)||i.addError({name:"format",argument:t.format,message:"does not conform to the "+JSON.stringify(t.format)+" format"}),i}},l.minLength=function(e,t,n,r){if(this.types.string(e)){var i=new a(e,t,n,r),o=e.match(/[\uDC00-\uDFFF]/g),s=e.length-(o?o.length:0);return s>=t.minLength||i.addError({name:"minLength",argument:t.minLength,message:"does not meet minimum length of "+t.minLength}),i}},l.maxLength=function(e,t,n,r){if(this.types.string(e)){var i=new a(e,t,n,r),o=e.match(/[\uDC00-\uDFFF]/g),s=e.length-(o?o.length:0);return s<=t.maxLength||i.addError({name:"maxLength",argument:t.maxLength,message:"does not meet maximum length of "+t.maxLength}),i}},l.minItems=function(e,t,n,r){if(this.types.array(e)){var i=new a(e,t,n,r);return e.length>=t.minItems||i.addError({name:"minItems",argument:t.minItems,message:"does not meet minimum length of "+t.minItems}),i}},l.maxItems=function(e,t,n,r){if(this.types.array(e)){var i=new a(e,t,n,r);return e.length<=t.maxItems||i.addError({name:"maxItems",argument:t.maxItems,message:"does not meet maximum length of "+t.maxItems}),i}},l.uniqueItems=function(e,t,n,r){function i(e,t,n){for(var r=t+1;r<n.length;r++)if(s.deepCompareStrict(e,n[r]))return!1;return!0}if(this.types.array(e)){var o=new a(e,t,n,r);return e.every(i)||o.addError({name:"uniqueItems",message:"contains duplicate item"}),o}},l.uniqueItems=function(e,t,n,r){if(this.types.array(e)){var i=new a(e,t,n,r);return e.every(o)||i.addError({name:"uniqueItems",message:"contains duplicate item"}),i}},l.dependencies=function(e,t,n,r){if(this.types.object(e)){var i=new a(e,t,n,r);for(var o in t.dependencies)if(void 0!==e[o]){var s=t.dependencies[o],u=r.makeChild(s,o);if("string"==typeof s&&(s=[s]),Array.isArray(s))s.forEach(function(t){void 0===e[t]&&i.addError({name:"dependencies",argument:u.propertyPath,message:"property "+t+" not found, required by "+u.propertyPath})});else{var c=this.validateSchema(e,s,n,u);i.instance!==c.instance&&(i.instance=c.instance),c&&c.errors.length&&(i.addError({name:"dependencies",argument:u.propertyPath,message:"does not meet dependency required by "+u.propertyPath}),i.importErrors(c))}}return i}},l.enum=function(e,t,n,r){if(void 0===e)return null;if(!Array.isArray(t.enum))throw new u("enum expects an array",t);var i=new a(e,t,n,r);return t.enum.some(s.deepCompareStrict.bind(null,e))||i.addError({name:"enum",argument:t.enum,message:"is not one of enum values: "+t.enum.map(String).join(",")}),i},l.const=function(e,t,n,r){if(void 0===e)return null;var i=new a(e,t,n,r);return s.deepCompareStrict(t.const,e)||i.addError({name:"const",argument:t.const,message:"does not exactly match expected constant: "+t.const}),i},l.not=l.disallow=function(e,t,n,r){var i=this;if(void 0===e)return null;var o=new a(e,t,n,r),s=t.not||t.disallow;return s?(Array.isArray(s)||(s=[s]),s.forEach(function(s){if(i.testType(e,t,n,r,s)){var a=s&&s.id&&"<"+s.id+">"||s;o.addError({name:"not",argument:a,message:"is of prohibited type "+a})}}),o):null},e.exports=c},function(e,t,n){"use strict";function r(e,t){return t+": "+e.toString()+"\n"}function i(e,t,n,r){"object"==typeof n?t[r]=a(e[r],n):e.indexOf(n)===-1&&t.push(n)}function o(e,t,n){t[n]=e[n]}function s(e,t,n,r){"object"==typeof t[r]&&t[r]&&e[r]?n[r]=a(e[r],t[r]):n[r]=t[r]}function a(e,t){var n=Array.isArray(t),r=n&&[]||{};return n?(e=e||[],r=r.concat(e),t.forEach(i.bind(null,e,r))):(e&&"object"==typeof e&&Object.keys(e).forEach(o.bind(null,e,r)),Object.keys(t).forEach(s.bind(null,e,t,r))),r}function u(e){return"/"+encodeURIComponent(e).replace(/~/g,"%7E")}var c=n(19),l=t.ValidationError=function(e,t,n,r,i,o){r&&(this.property=r),e&&(this.message=e),n&&(n.id?this.schema=n.id:this.schema=n),t&&(this.instance=t),this.name=i,this.argument=o,this.stack=this.toString()};l.prototype.toString=function(){return this.property+" "+this.message};var h=t.ValidatorResult=function(e,t,n,r){this.instance=e,this.schema=t,this.propertyPath=r.propertyPath,this.errors=[],this.throwError=n&&n.throwError,this.disableFormat=n&&n.disableFormat===!0};h.prototype.addError=function(e){var t;if("string"==typeof e)t=new l(e,this.instance,this.schema,this.propertyPath);else{if(!e)throw new Error("Missing error detail");if(!e.message)throw new Error("Missing error message");if(!e.name)throw new Error("Missing validator type");t=new l(e.message,this.instance,this.schema,this.propertyPath,e.name,e.argument)}if(this.throwError)throw t;return this.errors.push(t),t},h.prototype.importErrors=function(e){"string"==typeof e||e&&e.validatorType?this.addError(e):e&&e.errors&&Array.prototype.push.apply(this.errors,e.errors)},h.prototype.toString=function(e){return this.errors.map(r).join("")},Object.defineProperty(h.prototype,"valid",{get:function(){return!this.errors.length}});var f=t.SchemaError=function e(t,n){this.message=t,this.schema=n,Error.call(this,t),Error.captureStackTrace(this,e)};f.prototype=Object.create(Error.prototype,{constructor:{value:f,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var d=t.SchemaContext=function(e,t,n,r,i){this.schema=e,this.options=t,this.propertyPath=n,this.base=r,this.schemas=i};d.prototype.resolve=function(e){return c.resolve(this.base,e)},d.prototype.makeChild=function(e,t){var n=void 0===t?this.propertyPath:this.propertyPath+m(t),r=c.resolve(this.base,e.id||""),i=new d(e,this.options,n,r,Object.create(this.schemas));return e.id&&!i.schemas[r]&&(i.schemas[r]=e),i};var p=t.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,
uri:/^[a-zA-Z][a-zA-Z0-9+-.]*:[^\s]*$/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/,"utc-millisec":function(e){return"string"==typeof e&&parseFloat(e)===parseInt(e,10)&&!isNaN(e)},regex:function(e){var t=!0;try{new RegExp(e)}catch(e){t=!1}return t},style:/\s*(.+?):\s*([^;]+);?/g,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/};p.regexp=p.regex,p.pattern=p.regex,p.ipv4=p["ip-address"],t.isFormat=function(e,t,n){if("string"==typeof e&&void 0!==p[t]){if(p[t]instanceof RegExp)return p[t].test(e);if("function"==typeof p[t])return p[t](e)}else if(n&&n.customFormats&&"function"==typeof n.customFormats[t])return n.customFormats[t](e);return!0};var m=t.makeSuffix=function(e){return e=e.toString(),e.match(/[.\s\[\]]/)||e.match(/^[\d]/)?e.match(/^\d+$/)?"["+e+"]":"["+JSON.stringify(e)+"]":"."+e};t.deepCompareStrict=function e(t,n){if(typeof t!=typeof n)return!1;if(t instanceof Array)return n instanceof Array&&(t.length===n.length&&t.every(function(r,i){return e(t[i],n[i])}));if("object"==typeof t){if(!t||!n)return t===n;var r=Object.keys(t),i=Object.keys(n);return r.length===i.length&&r.every(function(r){return e(t[r],n[r])})}return t===n},e.exports.deepMerge=a,t.objectGetPath=function(e,t){for(var n,r=t.split("/").slice(1);"string"==typeof(n=r.shift());){var i=decodeURIComponent(n.replace(/~0/,"~").replace(/~1/g,"/"));if(!(i in e))return;e=e[i]}return e},t.encodePath=function(e){return e.map(u).join("")},t.getDecimalPlaces=function(e){var t=0;if(isNaN(e))return t;"number"!=typeof e&&(e=Number(e));var n=e.toString().split("e");if(2===n.length){if("-"!==n[1][0])return t;t=Number(n[1].slice(1))}var r=n[0].split(".");return 2===r.length&&(t+=r[1].length),t}},function(e,t,n){function r(e,t){this.id=e,this.ref=t}var i=n(19),o=n(26);e.exports.SchemaScanResult=r,e.exports.scan=function(e,t){function n(e,t){if(t&&"object"==typeof t){if(t.$ref){var r=i.resolve(e,t.$ref);return void(c[r]=c[r]?c[r]+1:0)}var l=t.id?i.resolve(e,t.id):e;if(l){if(l.indexOf("#")<0&&(l+="#"),u[l]){if(!o.deepCompareStrict(u[l],t))throw new Error("Schema <"+t+"> already exists with different definition");return u[l]}u[l]=t,"#"==l[l.length-1]&&(u[l.substring(0,l.length-1)]=t)}s(l+"/items",t.items instanceof Array?t.items:[t.items]),s(l+"/extends",t.extends instanceof Array?t.extends:[t.extends]),n(l+"/additionalItems",t.additionalItems),a(l+"/properties",t.properties),n(l+"/additionalProperties",t.additionalProperties),a(l+"/definitions",t.definitions),a(l+"/patternProperties",t.patternProperties),a(l+"/dependencies",t.dependencies),s(l+"/disallow",t.disallow),s(l+"/allOf",t.allOf),s(l+"/anyOf",t.anyOf),s(l+"/oneOf",t.oneOf),n(l+"/not",t.not)}}function s(e,t){if(t instanceof Array)for(var r=0;r<t.length;r++)n(e+"/"+r,t[r])}function a(e,t){if(t&&"object"==typeof t)for(var r in t)n(e+"/"+r,t[r])}var u={},c={};return n(e,t),new r(u,c)}},function(e,t){String.prototype.includes||!function(){"use strict";var e={}.toString,t=function(){try{var e={},t=Object.defineProperty,n=t(e,e,e)&&t}catch(e){}return n}(),n="".indexOf,r=function(t){if(null==this)throw TypeError();var r=String(this);if(t&&"[object RegExp]"==e.call(t))throw TypeError();var i=r.length,o=String(t),s=o.length,a=arguments.length>1?arguments[1]:void 0,u=a?Number(a):0;u!=u&&(u=0);var c=Math.min(Math.max(u,0),i);return!(s+c>i)&&n.call(r,o,u)!=-1};t?t(String.prototype,"includes",{value:r,configurable:!0,writable:!0}):String.prototype.includes=r}()},function(e,t){e.exports={user:{type:"object",properties:{id:{type:"string"},accountId:{type:"string"},email:{type:"string"},firstName:{type:"string"},lastName:{type:"string"},imageUrl:{type:"string"},referralCode:{type:"string"},locale:{type:"string"}},required:["id","accountId"]},userLookUp:{type:"object",properties:{id:{type:"string"},accountId:{type:"string"}},required:["id","accountId"]},userReferralCode:{type:"object",properties:{referralCode:{type:"string"}},required:["referralCode"]},applyReferralCode:{type:"object",properties:{id:{type:"string"},accountId:{type:"string"},referralCode:{type:"string"}},required:["id","accountId","referralCode"]},cookieUser:{type:"object",properties:{widgetType:{type:"string",default:""},engagementMedium:{type:"string",default:""}}},upsertUser:{type:"object",properties:{user:{type:"object",properties:{id:{type:"string"},accountId:{type:"string"},email:{type:"string"},firstName:{type:"string"},lastName:{type:"string"},imageUrl:{type:"string"},referredBy:{type:"object",properties:{code:{type:"string"},isConverted:{type:"boolean"}}},locale:{type:"string"},paymentProviderId:{type:"string"}},required:["id","accountId"]},widgetType:{type:"string",default:""},engagementMedium:{type:"string",default:""}},required:["user"]}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(r)},c=n(3),l=r(c),h=n(31),f=r(h),d=n(34),p=(0,l.default)("squatch-js:EMBEDwidget"),m=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#squatchembed";i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if(r.element=document.querySelector(n)||document.querySelector(".squatchembed"),!r.element)throw new Error("element with selector '"+n+"' not found.'");return r}return s(t,e),a(t,[{key:"load",value:function(){var e=this;e.element.firstChild&&"#text"!==e.element.firstChild.nodeName||e.element.appendChild(e.frame);var t=e.frame.contentWindow.document;t.open(),t.write(e.content),t.close(),(0,d.domready)(t,function(){var n=e.frame.contentWindow.squatch,r=t.getElementById("cta");r&&r.parentNode.removeChild(r),e.frame.height=t.body.scrollHeight;var i=new e.ResizeObserver(function(t){var n=!0,r=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value,u=a.contentRect.height;e.frame.height=u}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}}),o=t.getElementsByTagName("sqh-global-container"),s=o.length>0?o[0]:t.getElementsByClassName("squatch-container")[0];s||p("Error: no container found."),i.observe(s),e._loadEvent(n),p("loaded")})}},{key:"reload",value:function(e,t){var n=this,r=n.frame.contentWindow.document;n.widgetApi.cookieUser({user:{email:e.email||null,firstName:e.firstName||null,lastName:e.lastName||null},engagementMedium:"EMBED",widgetType:n.type,jwt:t}).then(function(t){if(t.template){n.content=t.template;var i=r.createElement("button"),o=r.getElementsByClassName("squatch-register")[0];o&&(i.className="btn btn-primary",i.id="show-stats-btn",i.textContent="REFERRER_WIDGET"===n.type?"Show Stats":"Show Reward",i.setAttribute("style","margin-top: 10px; max-width: 130px; width: 100%;"),i.onclick=function(){n.load()},o.style.paddingTop="30px",o.innerHTML="<p><strong>"+e.email+"</strong><br>Has been successfully registered</p>",o.appendChild(i))}}).catch(function(e){p(""+e.message)})}},{key:"_error",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"embed",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_error",this).call(this,e,n,r)}}]),t}(f.default);t.default=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(3),a=r(s),u=n(32),c=r(u),l=n(33),h=r(l),f=(0,a.default)("squatch-js:widget"),d=function(){function e(t){i(this,e),f("widget initializing ...");var n=this;n.content="error"===t.content?n._error(t.rsCode):t.content,n.type=t.type,n.widgetApi=t.api||"",n.analyticsApi=new h.default({domain:t.domain}),n.frame=document.createElement("iframe"),n.frame.squatchJsApi=n,n.frame.width="100%",n.frame.scrolling="no",n.frame.setAttribute("style","border: 0; background-color: none;"),n.ResizeObserver=c.default}return o(e,[{key:"_loadEvent",value:function(e){e&&this.analyticsApi.pushAnalyticsLoadEvent({tenantAlias:e.analytics.attributes.tenant,externalAccountId:e.analytics.attributes.accountId,externalUserId:e.analytics.attributes.userId,engagementMedium:e.mode.widgetMode}).then(function(t){f(e.mode.widgetMode+" loaded event recorded. "+t)}).catch(function(e){f(new Error("pushAnalyticsLoadEvent() "+e))})}},{key:"_shareEvent",value:function(e,t){e&&this.analyticsApi.pushAnalyticsShareClickedEvent({tenantAlias:e.analytics.attributes.tenant,externalAccountId:e.analytics.attributes.accountId,externalUserId:e.analytics.attributes.userId,engagementMedium:e.mode.widgetMode,shareMedium:t}).then(function(n){f(e.mode.widgetMode+" share "+t+" event recorded. "+n)}).catch(function(e){f(new Error("pushAnalyticsLoadEvent() "+e))})}},{key:"_inviteContacts",value:function(e,t){e&&this.widgetApi.invite({tenantAlias:e.analytics.attributes.tenant,accountId:e.analytics.attributes.accountId,userId:e.analytics.attributes.userId,emailList:t}).then(function(e){f("Sent email invites to share "+t+". "+e)}).catch(function(e){f(new Error("invite() "+e))})}},{key:"_error",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"modal",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=this;return r.errorTemplate='<!DOCTYPE html>\n    <!--[if IE 7]><html class="ie7 oldie" lang="en"><![endif]-->\n    <!--[if IE 8]><html class="ie8 oldie" lang="en"><![endif]-->\n    <!--[if gt IE 8]><!--><html lang="en"><!--<![endif]-->\n    <head>\n      <link rel="stylesheet" media="all" href="https://d2rcp9ak152ke1.cloudfront.net/assets/css/widget/errorpage.min.css">\n      <style>\n        '+n+'\n      </style>\n    </head>\n    <body>\n\n      <div class="squatch-container '+t+'">\n        <div class="errorheader">\n          <button type="button" class="close" onclick="window.frameElement.squatchJsApi.close();">&times;</button>\n          <p class="errortitle">Error</p>\n        </div>\n        <div class="errorbody">\n          <div class="sadface"><img src="https://d2rcp9ak152ke1.cloudfront.net/assets/images/face.png"></div>\n          <h4>Our referral program is temporarily unavailable.</h4><br>\n          <p>Please reload the page or check back later.</p>\n          <p>If the persists please contact our support team.</p>\n          <br>\n          <br>\n          <div class="right-align errtxt">\n            Error Code: '+e+"\n          </div>\n        </div>\n      </div>\n    </body>\n    </html>",r.errorTemplate}}]),e}();t.default=d},function(e,t,n){(function(t){!function(t,n){e.exports=n()}(this,function(){"use strict";function e(e){return parseFloat(e)||0}function n(t){for(var n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];return n.reduce(function(n,r){var i=t["border-"+r+"-width"];return n+e(i)},0)}function r(t){for(var n=["top","right","bottom","left"],r={},i=0,o=n;i<o.length;i+=1){var s=o[i],a=t["padding-"+s];r[s]=e(a)}return r}function i(e){var t=e.getBBox();return c(0,0,t.width,t.height)}function o(t){var i=t.clientWidth,o=t.clientHeight;if(!i&&!o)return E;var a=_(t).getComputedStyle(t),u=r(a),l=u.left+u.right,h=u.top+u.bottom,f=e(a.width),d=e(a.height);if("border-box"===a.boxSizing&&(Math.round(f+l)!==i&&(f-=n(a,"left","right")+l),Math.round(d+h)!==o&&(d-=n(a,"top","bottom")+h)),!s(t)){var p=Math.round(f+l)-i,m=Math.round(d+h)-o;1!==Math.abs(p)&&(f-=p),1!==Math.abs(m)&&(d-=m)}return c(u.left,u.top,f,d)}function s(e){return e===_(e).document.documentElement}function a(e){return h?x(e)?i(e):o(e):E}function u(e){var t=e.x,n=e.y,r=e.width,i=e.height,o="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,s=Object.create(o.prototype);return w(s,{x:t,y:n,width:r,height:i,top:n,right:t+r,bottom:i+n,left:t}),s}function c(e,t,n,r){return{x:e,y:t,width:n,height:r}}var l=function(){function e(e,t){var n=-1;return e.some(function(e,r){return e[0]===t&&(n=r,!0)}),n}return"undefined"!=typeof Map?Map:function(){function t(){this.__entries__=[]}var n={size:{configurable:!0}};return n.size.get=function(){return this.__entries__.length},t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){var n=this;void 0===t&&(t=null);for(var r=0,i=n.__entries__;r<i.length;r+=1){var o=i[r];e.call(t,o[1],o[0])}},Object.defineProperties(t.prototype,n),t}()}(),h="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,f=function(){return"undefined"!=typeof t&&t.Math===Math?t:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")()}(),d=function(){return"function"==typeof requestAnimationFrame?requestAnimationFrame.bind(f):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),p=2,m=function(e,t){function n(){o&&(o=!1,e()),s&&i()}function r(){d(n)}function i(){var e=Date.now();if(o){if(e-a<p)return;s=!0}else o=!0,s=!1,setTimeout(r,t);a=e}var o=!1,s=!1,a=0;return i},v=20,y=["top","right","bottom","left","width","height","size","weight"],g="undefined"!=typeof MutationObserver,b=function(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=m(this.refresh.bind(this),v)};b.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},b.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},b.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},b.prototype.updateObservers_=function(){var e=this.observers_.filter(function(e){return e.gatherActive(),e.hasActive()});return e.forEach(function(e){return e.broadcastActive()}),e.length>0},b.prototype.connect_=function(){h&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),g?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},b.prototype.disconnect_=function(){h&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},b.prototype.onTransitionEnd_=function(e){var t=e.propertyName;void 0===t&&(t="");var n=y.some(function(e){return!!~t.indexOf(e)});n&&this.refresh()},b.getInstance=function(){return this.instance_||(this.instance_=new b),this.instance_},b.instance_=null;var w=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n+=1){var i=r[n];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},_=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView;return t||f},E=c(0,0,0,0),x=function(){return"undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof _(e).SVGGraphicsElement}:function(e){return e instanceof _(e).SVGElement&&"function"==typeof e.getBBox}}(),O=function(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=c(0,0,0,0),this.target=e};O.prototype.isActive=function(){var e=a(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},O.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e};var A=function(e,t){var n=u(t);w(this,{target:e,contentRect:n})},j=function(e,t,n){if(this.activeObservations_=[],this.observations_=new l,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n};j.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof _(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new O(e)),this.controller_.addObserver(this),this.controller_.refresh())}},j.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof _(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},j.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},j.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},j.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(e){return new A(e.target,e.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},j.prototype.clearActive=function(){this.activeObservations_.splice(0)},j.prototype.hasActive=function(){return this.activeObservations_.length>0};var C="undefined"!=typeof WeakMap?new WeakMap:new l,k=function(e){if(!(this instanceof k))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=b.getInstance(),n=new j(e,t,this);C.set(this,n)};["observe","unobserve","disconnect"].forEach(function(e){k.prototype[e]=function(){return(t=C.get(this))[e].apply(t,arguments);var t}});var P=function(){return"undefined"!=typeof f.ResizeObserver?f.ResizeObserver:k}();return P})}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(12),a=r(s),u=function(){function e(t){i(this,e),this.domain=t.domain||"https://app.referralsaasquatch.com"}return o(e,[{key:"pushAnalyticsLoadEvent",value:function(t){var n=encodeURIComponent(t.tenantAlias),r=encodeURIComponent(t.externalAccountId),i=encodeURIComponent(t.externalUserId),o=encodeURIComponent(t.engagementMedium),s="/a/"+n+"/widgets/analytics/loaded?externalAccountId="+r+"&externalUserId="+i+"&engagementMedium="+o,a=this.domain+s;return e.doPost(a,JSON.stringify({}))}},{key:"pushAnalyticsShareClickedEvent",value:function(t){var n=encodeURIComponent(t.tenantAlias),r=encodeURIComponent(t.externalAccountId),i=encodeURIComponent(t.externalUserId),o=encodeURIComponent(t.engagementMedium),s=encodeURIComponent(t.shareMedium),a="/a/"+n+"/widgets/analytics/shared?externalAccountId="+r+"&externalUserId="+i+"&engagementMedium="+o+"&shareMedium="+s,u=this.domain+a;return e.doPost(u,JSON.stringify({}))}}],[{key:"doPost",value:function(e,t){var n={Accept:"application/json","Content-Type":"application/json"};return a.default.post(e).send(t).set(n).then(function(e){return e.text})}}]),e}();t.default=u},function(e,t){"use strict";function n(e,t){var n=[],r=void 0,i=e,o=i.documentElement.doScroll,s="DOMContentLoaded",a=(o?/^loaded|^c/:/^loaded|^i|^c/).test(i.readyState);return a||i.addEventListener(s,r=function(){for(i.removeEventListener(s,r),a=1;r=n.shift();)r()}),a?setTimeout(t,0):n.push(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.domready=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(r)},c=n(3),l=r(c),h=n(31),f=r(h),d=n(34),p=(0,l.default)("squatch-js:POPUPwidget"),m=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".squatchpop";i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),s=r;return s.triggerElement=document.querySelector(n),s.triggerElement&&(s.triggerElement.onclick=function(){s.open()}),s.triggerWhenCTA=document.querySelector(".squatchpop"),"#cta"===n&&s.triggerWhenCTA&&(s.triggerWhenCTA.onclick=function(){s.open()}),s.popupdiv=document.createElement("div"),s.popupdiv.id="squatchModal",s.popupdiv.setAttribute("style","display: none; position: fixed; z-index: 1; padding-top: 5%; left: 0; top: -2000px; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4);"),s.popupcontent=document.createElement("div"),s.popupcontent.setAttribute("style","margin: auto; width: 80%; max-width: 500px; position: relative;"),s.popupdiv.onclick=function(e){s._clickedOutside(e)},r}return s(t,e),a(t,[{key:"load",value:function(){var e=this;e.popupdiv.appendChild(e.popupcontent),document.body.appendChild(e.popupdiv),e.popupcontent.appendChild(e.frame);var t=e.frame.contentWindow.document;t.open(),t.write(e.content),t.close(),p("Popup template loaded into iframe")}},{key:"reload",value:function(e,t){var n=this,r=n.frame.contentWindow.document;n.widgetApi.cookieUser({user:{email:e.email||null,firstName:e.firstName||null,lastName:e.lastName||null},engagementMedium:"POPUP",widgetType:n.type,jwt:t}).then(function(t){if(t.template){n.content=t.template;var i=r.createElement("button"),o=r.getElementsByClassName("squatch-register")[0];o&&(i.className="btn btn-primary",i.id="show-stats-btn",i.textContent="REFERRER_WIDGET"===n.type?"Show Stats":"Show Reward",i.setAttribute("style","margin-top: 10px; max-width: 130px; width: 100%;"),i.onclick=function(){n.load(),n.open()},o.style.paddingTop="30px",o.innerHTML="<p><strong>"+e.email+"</strong><br>Has been successfully registered</p>",o.appendChild(i))}}).catch(function(e){p(""+e.message)})}},{key:"open",value:function(){var e=this,t=e.popupdiv,n=e.frame,r=n.contentWindow,i=r.document;(0,d.domready)(i,function(){var o=r.squatch,s=i.getElementById("cta");s&&s.parentNode.removeChild(s),i.body.style.overflowY="hidden",t.style.display="block",t.style.top="0",n.height=i.body.offsetHeight;var a=i.getElementsByTagName("sqh-global-container"),u=a.length>0?a[0]:i.getElementsByClassName("squatch-container")[0],c=new e.ResizeObserver(function(e){var r=!0,o=!1,s=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var l=a.value,h=l.contentRect.height,f=i.getElementsByClassName("squatch-referrals")[0],d=f?f.offsetHeight:0,p=h-d;p>0&&(n.height=p),window.innerHeight>n.height?t.style.paddingTop=(window.innerHeight-n.height)/2+"px":t.style.paddingTop="5px",u.style.width="100%",u.style.height=p+"px"}}catch(e){o=!0,s=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw s}}});u||p("Error: no container found."),c.observe(u),e._loadEvent(o),p("Popup opened")})}},{key:"close",value:function(){this.popupdiv.style.display="none",p("Popup closed")}},{key:"_clickedOutside",value:function(e){e.target===this.popupdiv&&this.close()}},{key:"_error",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"modal",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i="body { margin: 0; } .modal { box-shadow: none; border: 0; }";return u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_error",this).call(this,e,n,r||i)}}]),t}(f.default);t.default=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(r)},c=n(3),l=r(c),h=n(35),f=r(h),d=n(34),p=(0,l.default)("squatch-js:CTAwidget"),m=function(e){function t(e,n){i(this,t),p("CTA constructor");var r=document.createElement("div");r.id="cta",document.body.appendChild(r);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"#cta")),a=s;return n.side||n.position||(n.position="bottom",n.side="right"),"middle"===n.position?(a.position="top: 45%;",a.side="center"===n.side?"right: 45%;":n.side+": -10px;"):(a.position=n.position+": -10px;",a.side="center"===n.side?"right: 45%;":n.side+": 20px;"),a.positionClass=n.position,a.ctaFrame=document.createElement("iframe"),a.ctaFrame.squatchJsApi=a,a.ctaFrame.scrolling="no",a.ctaFrame.setAttribute("style","border:0; background-color:transparent; position:fixed; display:none;"+a.side+a.position),document.body.appendChild(s.ctaFrame),p("ctaframe appended to body"),s}return s(t,e),a(t,[{key:"load",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this);var e=this.frame.contentWindow.document,n=this.ctaFrame,r=this.positionClass,i=this.ResizeObserver;(0,d.domready)(e,function(){var t=e.getElementById("cta");if(t){t.parentNode.removeChild(t);var o=n.contentWindow.document;o.open(),o.write(t.innerHTML),o.close(),(0,d.domready)(o,function(){var e=o.getElementsByClassName("cta-container")[0];e.style.position="fixed",n.height=e.offsetHeight,n.width=e.scrollWidth,n.style.display="block",e.classList.contains(r)||(e.className+=" "+r);var t=new i(function(e){var t=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var a=o.value,u=a.contentRect,c=u.height,l=u.width;n.height=c,n.width=l}}catch(e){r=!0,i=e}finally{try{!t&&s.return&&s.return()}finally{if(r)throw i}}});t.observe(e),p("CTA template loaded into iframe")})}else p(new Error("CTA element not found in theme"))})}},{key:"open",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"open",this).call(this)}},{key:"close",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"close",this).call(this)}}]),t}(f.default);t.default=m},function(e,t){"use strict";function n(){var e=window.squatch||null,t=window._squatch||null;if(e&&t){var n=t.ready||[];n.forEach(function(e){return setTimeout(function(){return e()},0)}),window._squatch=void 0;try{delete window._squatch}catch(e){throw e}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n}])});